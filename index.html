<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Wettiq VIP – Tages-Tipps</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            background: radial-gradient(circle at top, #161b2b 0, #050712 45%, #02030a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px 12px;
            color: #f5f5f5;
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "SF Pro Text", sans-serif;
        }

        .wrapper {
            width: 100%;
            max-width: 980px;
            background: rgba(4, 8, 20, 0.96);
            border-radius: 28px;
            padding: 28px 24px 28px;
            box-shadow: 0 22px 60px rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(142, 160, 255, 0.18);
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
        }

        .title-block {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .title {
            letter-spacing: 0.22em;
            font-size: 12px;
            text-transform: uppercase;
            color: #a6b4ff;
        }

        .subtitle {
            font-size: 13px;
            color: rgba(223, 229, 255, 0.82);
        }

        .tag-pill {
            font-size: 11px;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            padding: 7px 14px;
            border-radius: 999px;
            border: 1px solid rgba(255, 222, 130, 0.8);
            background: linear-gradient(90deg, rgba(255, 204, 102, 0.12), rgba(255, 222, 158, 0.06));
            color: #ffdf92;
        }

        .section-title {
            font-size: 14px;
            margin-bottom: 8px;
            color: #f5f7ff;
        }

        .hint {
            font-size: 11px;
            line-height: 1.5;
            color: rgba(211, 220, 255, 0.82);
            margin-top: 10px;
        }

        .hint span {
            color: #ffb66a;
        }

        .textarea-wrapper {
            margin-top: 12px;
            margin-bottom: 14px;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            resize: vertical;
            padding: 14px 14px 14px;
            border-radius: 18px;
            border: 1px solid rgba(112, 129, 255, 0.6);
            background: radial-gradient(circle at 0 0, rgba(33, 46, 90, 0.52), rgba(6, 10, 30, 0.96));
            color: #f5f7ff;
            font-family: inherit;
            font-size: 13px;
            outline: none;
        }

        textarea::placeholder {
            color: rgba(165, 176, 220, 0.7);
        }

        .controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 12px;
        }

        .btn {
            border-radius: 999px;
            padding: 11px 18px;
            font-size: 13px;
            border: none;
            cursor: pointer;
            transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.08s ease, opacity 0.08s ease;
            font-family: inherit;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2f66ff, #4978ff);
            color: #fdfdff;
            box-shadow: 0 9px 22px rgba(10, 40, 120, 0.72);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 11px 26px rgba(10, 40, 120, 0.85);
        }

        .btn-ghost {
            background: transparent;
            border: 1px solid rgba(113, 135, 255, 0.7);
            color: #d9e0ff;
        }

        .btn-ghost:hover {
            background: rgba(19, 32, 94, 0.6);
            box-shadow: 0 7px 18px rgba(10, 24, 90, 0.55);
        }

        .btn-danger {
            background: linear-gradient(135deg, #be2d42, #e34a4f);
            color: #fff7f8;
            box-shadow: 0 9px 22px rgba(136, 14, 39, 0.6);
        }

        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 11px 26px rgba(136, 14, 39, 0.8);
        }

        .tips-list {
            margin-top: 18px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .tip-card {
            border-radius: 22px;
            padding: 13px 16px;
            background: radial-gradient(circle at 0 0, rgba(40, 58, 120, 0.38), rgba(8, 12, 34, 0.98));
            border: 1px solid rgba(118, 138, 255, 0.35);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }

        .tip-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .tip-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: rgba(179, 192, 255, 0.9);
        }

        .tip-match {
            font-size: 14px;
            color: #f7f8ff;
        }

        .tip-pick {
            font-size: 13px;
            color: rgba(211, 220, 255, 0.9);
        }

        .chip-row {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .chip {
            border-radius: 999px;
            padding: 5px 11px;
            font-size: 12px;
            border: 1px solid rgba(176, 196, 255, 0.85);
            color: #e4ebff;
        }

        .btn-small {
            padding: 7px 12px;
            font-size: 11px;
            border-radius: 999px;
            border: 1px solid rgba(111, 130, 220, 0.9);
            background: rgba(8, 15, 52, 0.9);
            color: #cdd7ff;
            cursor: pointer;
        }

        .footer-hint {
            margin-top: 10px;
            font-size: 11px;
            color: rgba(170, 183, 230, 0.9);
        }

        .footer-hint span {
            color: #ffcb7a;
        }

        @media (max-width: 720px) {
            .wrapper {
                padding: 20px 16px 20px;
                border-radius: 22px;
            }

            .tip-card {
                flex-direction: column;
                align-items: flex-start;
            }

            .chip-row {
                align-items: flex-start;
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }

            .btn, .btn-small {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
<div class="wrapper">
    <div class="header-row">
        <div class="title-block">
            <div class="title">Wettiq VIP</div>
            <div class="subtitle">Tages-Tipps vorbereiten und als Karte anzeigen</div>
        </div>
        <div class="tag-pill">VIP Testphase</div>
    </div>

    <div>
        <div class="section-title">Rohdaten aus CleverTip einfügen</div>
        <div class="textarea-wrapper">
            <textarea id="rawInput" placeholder="Beispiel:

Kroatien
VS
Färöer-Inseln
TargetTIPP
Über 2,5 Tore
Chart QUOTE
1.50"></textarea>
        </div>
        <div class="controls-row">
            <button class="btn btn-primary" id="btnAdd">Tipp hinzufügen</button>
            <button class="btn btn-ghost" id="btnShowCard">Tageskarte anzeigen</button>
            <button class="btn btn-danger" id="btnClear">Alle Tipps löschen</button>
        </div>
        <div class="hint">
            Hinweise:
            Du kannst Tipps mit 6 oder 7 Zeilen einfügen (CleverTip-Format).
            Wenn du keine Quote kopierst, wird automatisch „-“ gesetzt.
            Alle Tipps werden nur in deinem Browser gespeichert.
        </div>
    </div>

    <div class="tips-list" id="tipsList"></div>

    <div class="footer-hint">
        Tipp:
        <span>Erst Tipps eintragen, dann „Tageskarte anzeigen“ und dort „Als Bild herunterladen“ benutzen.</span>
    </div>
</div>

<script>
    const STORAGE_KEY = "wettiqTips";

    function loadTips() {
        try {
            const raw = localStorage.getItem(STORAGE_KEY);
            if (!raw) return [];
            const arr = JSON.parse(raw);
            return Array.isArray(arr) ? arr : [];
        } catch (e) {
            return [];
        }
    }

    function saveTips(tips) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(tips));
    }

    function parseCleverTip(raw) {
        const lines = raw
            .split(/\r?\n/)
            .map(l => l.trim())
            .filter(l => l.length > 0);

        if (lines.length === 0) {
            throw new Error("Kein Text gefunden.");
        }

        let match = "Spiel unbekannt";
        let pick = "Tipp nicht erkannt";
        let odds = "-";

        // Fall 1: CleverTip 6–7 Zeilen
        if (lines.length >= 6 && (lines[1].toLowerCase() === "vs" || lines[1].toLowerCase() === "vs.")) {
            const team1 = lines[0];
            const team2 = lines[2];
            match = team1 + " – " + team2;

            // Quote suchen
            for (const line of lines) {
                const m = line.replace(",", ".").match(/(\d+(\.\d+)?)/);
                if (m) {
                    odds = m[1];
                    break;
                }
            }

            // Tipp-Zeile suchen
            for (let i = 3; i < lines.length; i++) {
                const l = lines[i];
                const lower = l.toLowerCase();
                if (lower.startsWith("targettipp") || lower.startsWith("chart")) continue;
                if (/^\d+[,.]?\d*$/.test(lower)) continue;
                pick = l;
                break;
            }
        } else {
            // Einfacher 3-Zeilen-Fall:
            // Spiel: ...
            // Tipp: ...
            // Quote: ...
            const spielLine = lines.find(l => l.toLowerCase().startsWith("spiel"));
            const tippLine = lines.find(l => l.toLowerCase().startsWith("tipp"));
            const quoteLine = lines.find(l => l.toLowerCase().startsWith("quote"));

            if (spielLine && spielLine.includes(":")) {
                match = spielLine.split(":").slice(1).join(":").trim();
            } else if (lines.length >= 1) {
                match = lines[0];
            }

            if (tippLine && tippLine.includes(":")) {
                pick = tippLine.split(":").slice(1).join(":").trim();
            } else if (lines.length >= 2) {
                pick = lines[1];
            }

            if (quoteLine && quoteLine.includes(":")) {
                const q = quoteLine.split(":").slice(1).join(":").trim();
                const m = q.replace(",", ".").match(/(\d+(\.\d+)?)/);
                odds = m ? m[1] : "-";
            } else {
                for (const line of lines) {
                    const m = line.replace(",", ".").match(/(\d+(\.\d+)?)/);
                    if (m) {
                        odds = m[1];
                        break;
                    }
                }
            }
        }

        return { match, pick, odds };
    }

    function renderTips() {
        const tips = loadTips();
        const container = document.getElementById("tipsList");
        container.innerHTML = "";

        if (!tips.length) {
            return;
        }

        tips.forEach((tip, index) => {
            const card = document.createElement("div");
            card.className = "tip-card";

            const left = document.createElement("div");
            left.className = "tip-info";

            const label = document.createElement("div");
            label.className = "tip-label";
            label.textContent = "Tipp " + (index + 1);

            const match = document.createElement("div");
            match.className = "tip-match";
            match.textContent = tip.match;

            const pick = document.createElement("div");
            pick.className = "tip-pick";
            pick.textContent = "Tipp: " + tip.pick;

            left.appendChild(label);
            left.appendChild(match);
            left.appendChild(pick);

            const right = document.createElement("div");
            right.className = "chip-row";

            const quota = document.createElement("div");
            quota.className = "chip";
            quota.textContent = "Quote: " + (tip.odds || "-");

            const deleteBtn = document.createElement("button");
            deleteBtn.className = "btn-small";
            deleteBtn.textContent = "Löschen";
            deleteBtn.addEventListener("click", () => {
                const current = loadTips();
                current.splice(index, 1);
                saveTips(current);
                renderTips();
            });

            right.appendChild(quota);
            right.appendChild(deleteBtn);

            card.appendChild(left);
            card.appendChild(right);

            container.appendChild(card);
        });
    }

    document.getElementById("btnAdd").addEventListener("click", () => {
        const raw = document.getElementById("rawInput").value;
        if (!raw.trim()) {
            alert("Bitte CleverTip-Text einfügen.");
            return;
        }
        try {
            const tip = parseCleverTip(raw);
            const tips = loadTips();
            tips.push(tip);
            saveTips(tips);
            document.getElementById("rawInput").value = "";
            renderTips();
        } catch (e) {
            alert("Format konnte nicht erkannt werden. Fehler: " + e.message);
        }
    });

    document.getElementById("btnClear").addEventListener("click", () => {
        if (confirm("Alle gespeicherten Tipps löschen")) {
            saveTips([]);
            renderTips();
        }
    });

    document.getElementById("btnShowCard").addEventListener("click", () => {
        window.location.href = "karte.html";
    });

    document.addEventListener("DOMContentLoaded", renderTips);
</script>
</body>
</html>
